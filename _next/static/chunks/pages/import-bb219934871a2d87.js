(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[711],{2502:(e,o,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/import",function(){return t(6845)}])},6845:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>a});var r=t(4848),s=t(6540);class n{constructor(e,o,t,r){this.name="",this.recipePicture="",this.ingredients="",this.howToPrepare="",this.name=e,this.recipePicture=o,this.ingredients=t,this.howToPrepare=r}}var l=t(9028),c=t(6424);function a(){let[e,o]=(0,s.useState)(null),t=(0,s.useMemo)(()=>new l.A,[]),a=(0,c.useRouter)(),i=async o=>{if(o.preventDefault(),!e){alert("Selecione um arquivo para ser importado.");return}let r=await e.text();if(!r){alert("Arquivo inv\xe1lido.");return}let s=JSON.parse(r);if(!s){alert("Arquivo inv\xe1lido.");return}let l=s.map(e=>{var o,t,r;return e instanceof n?new n(e.name,null!==(o=e.recipePicture)&&void 0!==o?o:"",null!==(t=e.ingredients)&&void 0!==t?t:"",null!==(r=e.howToPrepare)&&void 0!==r?r:""):new n(e.title,"",e.ingredients,e.instructions)});await t.bulkCreate(l)||alert("Falha ao importar receitas."),alert("Receitas importadas com sucesso."),a.push("/recipes")};return(0,r.jsxs)("div",{className:"d-flex flex-column justify-content-center items-center h-100 row-gap-2",children:[(0,r.jsx)("h1",{className:"align-self-center",children:"Importar receitas"}),(0,r.jsxs)("form",{className:"d-flex flex-column form p-4 row-gap-3",onSubmit:e=>i(e),children:[(0,r.jsx)("input",{type:"file",accept:"application/JSON",className:"form-control mx-auto",onChange:e=>o(e.target.files?e.target.files[0]:null)}),(0,r.jsx)("button",{className:"btn btn-secondary mx-auto",type:"submit",children:"Importar"})]})]})}},9028:(e,o,t)=>{"use strict";let r;t.d(o,{A:()=>a});let s="recipesDatabase",n="recipes";function l(e){e.onupgradeneeded=()=>{r=e.result,console.log("openDatabase:onupgradeneeded"),r.objectStoreNames.contains(n)||r.createObjectStore(n,{keyPath:"id",autoIncrement:!0})},e.onerror=()=>{console.error("Database Error",e.error)},e.onblocked=()=>{alert("Banco de dados bloqueado")}}function c(){r.onversionchange=()=>{console.log("openDatabase:onversionchange"),null!=r&&(r.close(),alert("Banco de dados desatualizado. Atualize a p\xe1gina."))}}class a{getAll(){let e=indexedDB.open(s,1);return l(e),console.log("get all called"),new Promise((o,t)=>{e.onsuccess=()=>{r=e.result,console.log("success openning database"),c();let s=r.transaction(n),l=s.objectStore(n).getAll();console.log("getAll request: ".concat(l)),l.onerror=()=>t(l.error),l.onsuccess=()=>{o(l.result)},s.oncomplete=()=>{console.log("getAll result: ".concat(l.result)),r.close()}}})}getById(e){console.log("getById called");let o=indexedDB.open(s,1);return l(o),new Promise((t,s)=>{o.onsuccess=()=>{r=o.result,console.log("success openning database"),c();let l=r.transaction(n),a=l.objectStore(n).get(e);console.log("getAll request: ".concat(a)),a.onerror=()=>s(a.error),a.onsuccess=()=>{t(a.result)},l.oncomplete=()=>{console.log("getAll result: ".concat(a.result)),r.close()}}})}create(e){let o=indexedDB.open(s,1);l(o),o.onsuccess=()=>{r=o.result,c();let t=r.transaction(n,"readwrite"),s=t.objectStore(n);console.log("recipe to be saved: ".concat(e)),void 0==e.id&&delete e.id;let l=s.put(e);l.onsuccess=()=>console.log("adicionado com sucesso",l.result),l.onerror=()=>console.log("erro ao adicionar",l.error),t.oncomplete=()=>r.close()}}async bulkCreate(e){let o=indexedDB.open(s,1);return l(o),new Promise((t,s)=>{o.onsuccess=()=>{r=o.result,c();let l=r.transaction(n,"readwrite"),a=l.objectStore(n);for(let o of(console.log("recipes to be saved: ".concat(e)),e)){let e=a.put(o);e.onsuccess=()=>t(!0),e.onerror=()=>s(e.error)}l.oncomplete=()=>r.close()}})}delete(e){let o=indexedDB.open(s,1);l(o),o.onsuccess=()=>{r=o.result,c();let t=r.transaction(n,"readwrite"),s=t.objectStore(n);console.log("recipe id to be deleted: ".concat(e));let l=s.delete(e);l.onsuccess=()=>console.log("deletado com sucesso",l.result),l.onerror=()=>console.log("erro ao deletar",l.error),t.oncomplete=()=>r.close()}}}}},e=>{var o=o=>e(e.s=o);e.O(0,[424,636,593,792],()=>o(2502)),_N_E=e.O()}]);